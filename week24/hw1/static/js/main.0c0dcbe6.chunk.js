(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{30:function(t,n,e){},38:function(t,n,e){"use strict";e.r(n);var c,o,r=e(0),i=e.n(r),a=e(17),s=e.n(a),u=(e(30),e(2)),j=e(3),b=e(9),d=e(6),l=e(7),h=e(4),p=e(16),O="token",x=function(t){localStorage.setItem(O,t)},f=function(){return localStorage.getItem(O)},g="https://student-json-api.lidemy.me",m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return fetch("".concat(g,"/posts?_sort=createdAt&_order=desc&_limit=5&_page=").concat(t)).then((function(t){var n=t.headers.get("x-total-count");return{res:t.json(),amount:n}}))},v=function(){var t=f();return fetch("".concat(g,"/me"),{headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))},y=Object(p.b)({name:"user",initialState:{user:null,errorMessage:""},reducers:{setUser:function(t,n){t.user=n.payload},setErrorMessage:function(t,n){t.errorMessage=n.payload}}}),w=y.actions,S=w.setUser,k=w.setErrorMessage,E=function(t,n,e){return function(c){(function(t,n){return fetch("".concat(g,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})}).then((function(t){return t.json()}))})(t,n).then((function(t){if(0===t.ok)return c(k(t.message));x(t.token),v().then((function(t){if(1!==t.ok)return x(null),c(k(t.toString()));c(S(t.data)),e.push("/")}))}))}},P=function(t,n,e,c){return function(o){(function(t,n,e){return fetch("".concat(g,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n,nickname:e})}).then((function(t){return t.json()}))})(t,n,e).then((function(t){if(0===t.ok)return o(k(t.message));x(t.token),v().then((function(t){if(1!==t.ok)return x(null),o(k(t.toString()));o(S(t.data)),c.push("/")}))}))}},C=y.reducer,A=e(1),$=j.a.div(c||(c=Object(u.a)(["\n  color: red;\n"]))),L=j.a.div(o||(o=Object(u.a)(["\n  margin: 0 auto;\n  text-align: center;\n  margin-top: 80px;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  max-width: 500px;\n  min-height: 200px;\n  box-shadow: 4px 4px 4px 4px rgba(0, 0, 0, 0.2);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"])));function M(){var t=Object(r.useState)(""),n=Object(l.a)(t,2),e=n[0],c=n[1],o=Object(r.useState)(""),i=Object(l.a)(o,2),a=i[0],s=i[1],u=Object(h.c)((function(t){return t.user.errorMessage})),j=Object(d.g)(),b=Object(h.b)();Object(r.useEffect)((function(){return function(){b(k(null))}}),[b]);return Object(A.jsx)(L,{children:Object(A.jsxs)("form",{onSubmit:function(){b(k(null)),b(E(e,a,j))},children:[Object(A.jsxs)("div",{children:["\u5e33\u865f\uff1a",Object(A.jsx)("input",{value:e,onChange:function(t){return c(t.target.value)}})]}),Object(A.jsxs)("div",{children:["\u5bc6\u78bc\uff1a",Object(A.jsx)("input",{type:"password",value:a,onChange:function(t){return s(t.target.value)}})]}),Object(A.jsx)("button",{children:"\u767b\u5165"}),u&&Object(A.jsx)($,{children:u})]})})}var z,B,R,I,J,N,T,D,_,U,W,G,H,q=Object(p.b)({name:"posts",initialState:{user:null,isLoadingPost:!1,post:null,newPostResponse:null,posts:[],amount:0},reducers:{setIsLoadingPost:function(t,n){t.isLoadingPost=n.payload},setPost:function(t,n){t.post=n.payload},setNewPostResponse:function(t,n){t.newPostResponse=n.payload},setPosts:function(t,n){t.posts=n.payload},setAmount:function(t,n){t.amount=n.payload},setAuth:function(t,n){t.user=n.payload}}}),F=q.actions,K=F.setIsLoadingPost,Q=F.setPost,V=F.setNewPostResponse,X=F.setPosts,Y=F.setAmount,Z=(F.setAuth,function(t){return function(n){n(K(!0)),function(t){return fetch("".concat(g,"/posts?id=").concat(t),{}).then((function(t){return t.json()}))}(t).then((function(t){console.log(t),n(Q(t)),n(K(!1))}))}}),tt=function(t){return function(n){(function(t){var n=f();return fetch("".concat(g,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(n),"content-type":"application/json"},body:JSON.stringify(t)}).then((function(t){return t.json()}))})(t).then((function(t){n(V(t))})).catch((function(t){return console.log(t)}))}},nt=function(t){return function(n){m(t).then((function(t){return n(Y(t.amount)),t.res})).then((function(t){n(X(t))})).catch((function(t){return console.log(t)}))}},et=function(t,n){return function(e){(function(t){var n=f();return fetch("".concat(g,"/posts/").concat(t),{method:"DELETE",headers:{authorization:"Bearer ".concat(n),"content-type":"application/json"}}).then((function(t){return t.json()}))})(t).then((function(){m(n).then((function(t){return e(Y(t.amount)),t.res})).then((function(t){return e(X(t))}))}))}},ct=function(t,n){return function(e){(function(t,n){var e=f();return fetch("".concat(g,"/posts/").concat(t),{method:"PATCH",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify(n)}).then((function(t){return t.json()}))})(t,n).then((function(){e(Z(t))}))}},ot=q.reducer,rt=j.a.div(z||(z=Object(u.a)(["\n  width: 85%;\n  margin: 0 auto;\n"]))),it=j.a.div(B||(B=Object(u.a)(["\n  border-bottom: 1px solid rgba(o, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]))),at=Object(j.a)(b.b)(R||(R=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]))),st=j.a.div(I||(I=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]))),ut=j.a.div(J||(J=Object(u.a)(["\n  display: inline-block;\n  border: 1px solid black;\n  margin-right: 5px;\n  padding: 5px;\n  cursor: pointer;\n  ","\n"])),(function(t){return t.$active&&"\n      background: rgba(0, 0, 0, 0.1);\n      font-weight: bold;\n    "})),jt=j.a.div(N||(N=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  margin-top: 80px;\n"]))),bt=Object(j.a)(b.b)(T||(T=Object(u.a)(["\n  color: black;\n  text-decoration: none;\n"]))),dt=j.a.div(D||(D=Object(u.a)(["\n  \n"])));function lt(t){var n=t.post,e=t.handleDelete,c=t.user;t.handleEdit;return Object(A.jsxs)(it,{children:[Object(A.jsx)(at,{to:"/posts/".concat(n.id),children:n.title}),Object(A.jsxs)(dt,{children:[Object(A.jsx)(st,{children:new Date(n.createdAt).toLocaleString()}),c&&Object(A.jsx)(bt,{to:"",onClick:function(){return e(n.id)},children:"\u522a\u9664"})]})]})}function ht(){var t=Object(r.useState)([]),n=Object(l.a)(t,2),e=n[0],c=n[1],o=Object(r.useState)("1"),i=Object(l.a)(o,2),a=i[0],s=i[1],u=Object(h.c)((function(t){return t.user.user})),j=Object(h.b)(),b=Object(h.c)((function(t){return t.posts.posts})),d=Object(h.c)((function(t){return t.posts.amount}));Object(r.useEffect)((function(){j(nt())}),[j]),Object(r.useEffect)((function(){for(var t=[],n=1;n<=Math.ceil(d/5);n++)t.push(n);c(t)}),[d]);var p=function(t){j(et(t,a))},O=function(t){j(ct(t,a))};return Object(A.jsxs)(rt,{children:[b.map((function(t){return Object(A.jsx)(lt,{user:u,handleEdit:O,handleDelete:p,post:t},t.id)})),Object(A.jsx)(jt,{children:e.map((function(t){return Object(A.jsx)(ut,{value:t,$active:a===t.toLocaleString(),onClick:function(t){!function(t){var n=t.target.innerText;s(n),j(nt(n))}(t)},children:t},t)}))})]})}var pt,Ot,xt=j.a.div(_||(_=Object(u.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n"]))),ft=j.a.div(U||(U=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]))),gt=j.a.div(W||(W=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n"]))),mt=Object(j.a)(b.b)(G||(G=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  ","\n"])),(function(t){return t.$active&&"\n    background: rgba(0, 0, 0, 0.1)\n  "})),vt=j.a.div(H||(H=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  height: 100%;\n  "," {\n    margin-left: 32px;\n  }\n"])),gt);function yt(){var t=Object(d.h)(),n=Object(d.g)(),e=Object(h.c)((function(t){return t.user.user})),c=Object(h.b)();return Object(A.jsxs)(xt,{children:[Object(A.jsxs)(vt,{children:[Object(A.jsx)(ft,{children:"\u6211\u7684\u7b2c\u4e00\u500b\u90e8\u843d\u683c"}),Object(A.jsxs)(gt,{children:[Object(A.jsx)(mt,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),Object(A.jsx)(mt,{to:"/about",$active:"/about"===t.pathname,children:"About"}),e&&Object(A.jsx)(mt,{to:"/new-post",$active:"/new-post"===t.pathname,children:"\u767c\u5e03\u6587\u7ae0"})]})]}),Object(A.jsxs)(gt,{children:[!e&&Object(A.jsx)(mt,{to:"/register",$active:"/register"===t.pathname,children:"\u8a3b\u518a"}),!e&&Object(A.jsx)(mt,{to:"/login",$active:"/login"===t.pathname,children:"\u767b\u5165"}),e&&Object(A.jsx)(mt,{to:"",onClick:function(){x(""),c(S(null)),"/"!==t.pathname&&n.push("/")},children:"\u767b\u51fa"})]})]})}var wt,St,kt=j.a.div(pt||(pt=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  margin-top: 40px;\n  line-height: 1.5;\n"]))),Et=Object(j.a)(b.b)(Ot||(Ot=Object(u.a)(["\n  color: black;\n  text-decoration: none;\n  display: inline-block;\n  margin-bottom: 20px;\n  border: 1px solid black;\n"])));function Pt(){var t=Object(h.b)(),n=Object(h.c)((function(t){return t.posts.post})),e=Object(h.c)((function(t){return t.user.user})),c=Object(d.i)().id;return Object(r.useEffect)((function(){console.log("redner"),t(Z(c))}),[c,t]),Object(A.jsxs)(kt,{children:[e&&Object(A.jsx)(Et,{to:"/edit-post/".concat(c),children:"\u7de8\u8f2f"}),n&&Object(A.jsx)("h2",{children:n[0].title}),n&&Object(A.jsx)("div",{children:n[0].body}),Object(A.jsx)("br",{})]})}var Ct,At,$t=j.a.div(wt||(wt=Object(u.a)(["\n  color: red;\n"]))),Lt=j.a.div(St||(St=Object(u.a)(["\n  margin: 0 auto;\n  text-align: center;\n  margin-top: 80px;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  max-width: 500px;\n  min-height: 200px;\n  box-shadow: 4px 4px 4px 4px rgba(0, 0, 0, 0.2);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n"])));function Mt(){var t=Object(r.useState)(""),n=Object(l.a)(t,2),e=n[0],c=n[1],o=Object(r.useState)(""),i=Object(l.a)(o,2),a=i[0],s=i[1],u=Object(r.useState)(""),j=Object(l.a)(u,2),b=j[0],p=j[1],O=Object(h.c)((function(t){return t.user.errorMessage})),x=Object(d.g)(),f=Object(h.b)();Object(r.useEffect)((function(){return function(){f(k(null))}}),[f]);return Object(A.jsx)(Lt,{children:Object(A.jsxs)("form",{onSubmit:function(t){f(k(null)),f(P(e,a,b,x))},children:[Object(A.jsxs)("div",{children:["\u5e33\u865f\uff1a ",Object(A.jsx)("input",{value:e,onChange:function(t){return c(t.target.value)}})]}),Object(A.jsxs)("div",{children:["\u5bc6\u78bc\uff1a ",Object(A.jsx)("input",{type:"password",value:a,onChange:function(t){return s(t.target.value)}})]}),Object(A.jsxs)("div",{children:["\u66b1\u7a31\uff1a ",Object(A.jsx)("input",{value:b,onChange:function(t){return p(t.target.value)}})]}),Object(A.jsx)("button",{children:"\u8a3b\u518a"}),O&&Object(A.jsx)($t,{children:O})]})})}var zt,Bt,Rt=j.a.div(Ct||(Ct=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  margin-top: 40px;\n  line-height: 1.5;\n"]))),It=j.a.div(At||(At=Object(u.a)(["\n  margin: 0 auto;\n  text-align: center;\n  margin-top: 80px;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  max-width: 800px;\n  min-height: 70vh;\n  box-shadow: 4px 4px 4px 4px rgba(0, 0, 0, 0.2);\n  margin-bottom: 40px;\n  textarea{\n    height: 300px;\n    width: 80%;\n    margin-top: 20px;\n  }\n  input{\n    margin-top: 40px;\n    width: 80%\n  }\n"])));function Jt(){var t=Object(r.useState)(""),n=Object(l.a)(t,2),e=n[0],c=n[1],o=Object(r.useState)(""),i=Object(l.a)(o,2),a=i[0],s=i[1],u=Object(d.g)(),j=Object(h.b)(),b=Object(h.c)((function(t){return t.posts.newPostResponse}));return Object(r.useEffect)((function(){return function(){j(V(null))}}),[j]),Object(r.useEffect)((function(){b&&b.id&&u.push("/")}),[b,u]),Object(A.jsx)(Rt,{children:Object(A.jsx)(It,{children:Object(A.jsxs)("form",{onSubmit:function(){j(tt({title:e,body:a}))},children:[Object(A.jsxs)("div",{children:["\u6a19\u984c\uff1a",Object(A.jsx)("input",{value:e,onChange:function(t){return c(t.target.value)}})]}),Object(A.jsxs)("div",{children:["\u5167\u5bb9\uff1a",Object(A.jsx)("textarea",{value:a,onChange:function(t){return s(t.target.value)}})]}),Object(A.jsx)("button",{children:"\u9001\u51fa"})]})})})}var Nt,Tt,Dt=j.a.div(zt||(zt=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n  margin-top: 40px;\n  line-height: 1.5;\n"]))),_t=j.a.div(Bt||(Bt=Object(u.a)(["\n  margin: 0 auto;\n  text-align: center;\n  margin-top: 80px;\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  max-width: 800px;\n  min-height: 70vh;\n  box-shadow: 4px 4px 4px 4px rgba(0, 0, 0, 0.2);\n  margin-bottom: 40px;\n  textarea{\n    height: 300px;\n    width: 80%;\n    margin-top: 20px;\n  }\n  input{\n    margin-top: 40px;\n    width: 80%\n  }\n"])));function Ut(){var t=Object(r.useState)(""),n=Object(l.a)(t,2),e=n[0],c=n[1],o=Object(r.useState)(""),i=Object(l.a)(o,2),a=i[0],s=i[1],u=Object(d.g)(),j=Object(h.c)((function(t){return t.posts.post})),b=Object(h.b)(),p=Object(h.c)((function(t){return t.posts.newPostResponse})),O=Object(d.i)().id;return Object(r.useEffect)((function(){b(Z(O))}),[O,b]),Object(r.useEffect)((function(){c(j[0].title),s(j[0].body)}),[j]),Object(r.useEffect)((function(){p&&p.id&&u.push("/")}),[p,u]),Object(A.jsx)(Dt,{children:Object(A.jsx)(_t,{children:Object(A.jsxs)("form",{onSubmit:function(){b(ct(O,{title:e,body:a})),u.push("/posts/".concat(O))},children:[Object(A.jsxs)("div",{children:["\u6a19\u984c\uff1a",Object(A.jsx)("input",{value:e,onChange:function(t){return c(t.target.value)}})]}),Object(A.jsxs)("div",{children:["\u5167\u5bb9\uff1a",Object(A.jsx)("textarea",{value:a,onChange:function(t){return s(t.target.value)}})]}),Object(A.jsx)("button",{children:"\u9001\u51fa"})]})})})}var Wt,Gt=j.a.div(Nt||(Nt=Object(u.a)(["\n  width: 60%;\n  margin: 0 auto;\n  margin-top: 5%;\n"]))),Ht=j.a.div(Tt||(Tt=Object(u.a)(["\n  margin-top: 20%;\n  text-align: right;\n"])));function qt(){return Object(A.jsxs)(Gt,{children:[Object(A.jsx)("p",{children:"\u5566\u5566\u5566~~~ React \u63a5 API BLOG~~~~"}),Object(A.jsx)("p",{children:"\u4e0d\u60f3\u6392\u7248~~~~~"}),Object(A.jsx)("p",{children:"\u597d\u7d2f~~~~~"}),Object(A.jsxs)(Ht,{children:[Object(A.jsx)("p",{children:"\u9084\u662f\u7a0d\u5fae\u6392\u4e00\u4e0b\u597d\u4e86"}),Object(A.jsx)("p",{children:"\u4e0d\u77e5\u9053\u600e\u9ebc\u6392"}),Object(A.jsx)("p",{children:"\u9019\u6a23\u770b\u8d77\u4f86\u597d\u50cf\u5f88\u6587\u9752"})]})]})}var Ft=j.a.div(Wt||(Wt=Object(u.a)(["\n  padding-top: 64px;\n"])));var Kt=function(){var t=Object(h.c)((function(t){return t.user.user})),n=Object(h.b)();return Object(r.useEffect)((function(){f()&&n((function(t){v().then((function(n){n.ok&&t(S(n.data))}))}))}),[n]),Object(A.jsx)(Ft,{children:Object(A.jsxs)(b.a,{children:[Object(A.jsx)(yt,{}),Object(A.jsxs)(d.d,{children:[Object(A.jsx)(d.b,{exact:!0,path:"/",children:Object(A.jsx)(ht,{})}),Object(A.jsx)(d.b,{exact:!0,path:"/login",children:t?Object(A.jsx)(d.a,{to:"/"}):Object(A.jsx)(M,{})}),Object(A.jsx)(d.b,{exact:!0,path:"/posts/:id",children:Object(A.jsx)(Pt,{})}),Object(A.jsx)(d.b,{exact:!0,path:"/register",children:t?Object(A.jsx)(d.a,{to:"/"}):Object(A.jsx)(Mt,{})}),Object(A.jsx)(d.b,{exact:!0,path:"/new-post",children:t?Object(A.jsx)(Jt,{}):Object(A.jsx)(d.a,{to:"/login"})}),Object(A.jsx)(d.b,{exact:!0,path:"/edit-post/:id",children:t?Object(A.jsx)(Ut,{}):Object(A.jsx)(d.a,{to:"/login"})}),Object(A.jsx)(d.b,{exact:!0,path:"/about",children:Object(A.jsx)(qt,{})})]})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Qt=Object(p.a)({reducer:{posts:ot,user:C}});s.a.render(Object(A.jsx)(i.a.StrictMode,{children:Object(A.jsx)(h.a,{store:Qt,children:Object(A.jsx)(Kt,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[38,1,2]]]);
//# sourceMappingURL=main.0c0dcbe6.chunk.js.map